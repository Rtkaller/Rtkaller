Extracting prog: 53.660097679s
Minimizing prog: 2m46.358418618s
Simplifying prog options: 0s
Extracting C: 12.796132151s
Simplifying C: 1m21.080376546s


591 programs, 4 VMs, timeouts [15s 1m0s 6m0s]
extracting reproducer from 591 programs
single: executing 4 programs separately with timeout 15s
testing program (duration=15s, {Threaded:true Collide:true Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): syz_open_procfs-sendmsg$IPCTNL_MSG_CT_NEW-preadv
detailed listing:
executing program 0:
r0 = syz_open_procfs(0xffffffffffffffff, &(0x7f0000000100)='net/packet\x00')
sendmsg$IPCTNL_MSG_CT_NEW(r0, &(0x7f0000000240)={&(0x7f0000000000)={0x10, 0x0, 0x0, 0x80000}, 0xc, &(0x7f0000000200)={&(0x7f00000002c0)=ANY=[@ANYBLOB="8c000001000007100005800b000100616d616e64b900002c000f80080002407fffffff0800014000000006080001400000b44a080001400000000008000240e5ffff0104000180060012400001000024001880f2000400000000000800024000000c64080001408000000200000000000000ff0c0002800600034000000000d8d9aafc24380e75cc327787672765fc8438cea010a489889ef07b128a2c8d79dd0f78434d309088272f40e3e59fdfcc74ad8666f591ac8c480ffb5e62a8c7b9a72e08aca468f1a27173bb33d43d505025690fb5441e1024df85fff33cd8800285d136da5320c7c477f3d55bc125a00508d64b23b4dffca423a87f70ef50db3ec87ddd71a2030686cf4cddcc551671cf4a589d35c9180f15f748f703c3a3cad578e5a9012ce0d0092de3568ad2062ed6403c341bdd714c5b393f59a690e67a5eda3183b1e9d0af1ba69b623238a98742085e02be78320fb5bace1544bceab2ac9627f3debf24843de3f2ffd0718b74c012c05b5d3cde88ab991e3aa82180"], 0x8c}, 0x1, 0x0, 0x0, 0x8010}, 0x20000004)
preadv(r0, &(0x7f0000000500)=[{&(0x7f0000000040)=""/44, 0x2c}, {&(0x7f0000000080)=""/79, 0x4f}], 0x2, 0x0, 0x0)

program did not crash
testing program (duration=15s, {Threaded:true Collide:true Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): dup-io_submit-perf_event_open-syz_open_procfs-close-ioctl$F2FS_IOC_GET_PIN_FILE-openat$vcsu-shutdown-syz_open_procfs-syz_open_procfs-close-sendmsg$NFNL_MSG_ACCT_GET
detailed listing:
executing program 0:
r0 = dup(0xffffffffffffffff)
io_submit(0x0, 0x5, &(0x7f0000000580)=[&(0x7f00000001c0)={0x0, 0x0, 0x0, 0x3, 0x5, r0, &(0x7f0000000100)="63c4573a07d51d4dd3468b4e8890af23c9cc7ea2074195c55211a1b760c9e9ddddfd8626c3d0da71f28f768b7c8704d9c94565a31e307a7c36596e686bbcbd1f2f35a107ab28630e4be4b7ea073dc326030c4f96a747d575cd171d423f88ed8ec39412c0a10a251c91f1e5646eba5a8b88c325b877c1676840dc66ee91193a06db5e2d1e208c60d2d6d01e1e829801a08de793dafa3b454f453a7dc77634795558c772272abf700f44d136d2d6", 0xad, 0x7, 0x0, 0x2}, &(0x7f0000000280)={0x0, 0x0, 0x0, 0x2, 0x1, 0xffffffffffffffff, &(0x7f0000000200)="7517029467ef5945611d4a07ce0e8e1fad4922f67ef2e7daa79896ec9902ce1f8bc14b29c7743a2ada53716c6325d2ce644d9b7b93869193c2474f945d07844e5c932e10d740fbf31812cea84c033504a8e772bfb4a7d6c2bc45f2d00b0c505613e0eb9f82", 0x65, 0x3f, 0x0, 0x3}, &(0x7f0000000300)={0x0, 0x0, 0x0, 0x3, 0x1ff, 0xffffffffffffffff, &(0x7f00000002c0), 0x0, 0x8}, &(0x7f0000000400)={0x0, 0x0, 0x0, 0x1, 0xb792, 0xffffffffffffffff, &(0x7f0000000340)="eda6dccc578724f0e466255858035d3c34379ee1fe6ea5a6443b1a495bee141faf46635f3b887eeedf2ec8627926aa35eb07bfb5180de9ded3a6c65287bf87a3de0d7c6c49021700de0e8705da19e49c803b4af9c3262404aa5dfa33ad99d7049d2bcb5e306f591195816139fae90feec46c6978933da9338f0c7480037b6552175cef6c77949e726116888c682042e6d839bae33c741c6592efa0865e92f0cba9371774109da26c4f8d307c253d3fb64afb3f1feb77cd0f183099", 0xbb, 0x7, 0x0, 0x2}, &(0x7f0000000540)={0x0, 0x0, 0x0, 0xf6e0cdfa3cee6c79, 0xf48a, 0xffffffffffffffff, &(0x7f0000000440)="0c8cac8981641edfb5122c67caa1be220e41f68874c3a31a81762c4c701a99290717661e9c3759ece8a85fb433747ee60e390930359e466a2de0a620cd8a940396a0d48f5dcba59ff35c012da446adef637d57a7d3cb0ab68427863e94ce8586759dd7473ec7782b90ad44dca1fc9e75b1ec6f18b06c084dc8d7f7d2c63cb956cfef6d1bf64a8a115485ff9f845223caea5b068469f5231fc4cdfebd57eceb90bda6883f248cb53aa1e2ceeb041c5abacbe58f484c9c24ed69227eb203d9f75520b11604ebb887bd8849b10e", 0xcc, 0x6}])
perf_event_open(&(0x7f0000000000)={0x0, 0x70, 0x0, 0x0, 0x0, 0x0, 0x0, 0xd7d, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_config_ext, 0x20}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
r1 = syz_open_procfs(0xffffffffffffffff, &(0x7f0000000000)='net/route\x00')
close(r1)
ioctl$F2FS_IOC_GET_PIN_FILE(r1, 0x8004f50e, &(0x7f00000000c0))
r2 = openat$vcsu(0xffffffffffffff9c, &(0x7f0000000080)='/dev/vcsu\x00', 0x2, 0x0)
shutdown(r2, 0x1)
syz_open_procfs(0xffffffffffffffff, &(0x7f0000000000)='net/route\x00')
r3 = syz_open_procfs(0xffffffffffffffff, &(0x7f0000000000)='net/route\x00')
close(r3)
sendmsg$NFNL_MSG_ACCT_GET(r3, &(0x7f0000000640)={&(0x7f00000002c0)={0x10, 0x0, 0x0, 0x4000}, 0xc, &(0x7f0000000600)={&(0x7f00000005c0)={0x34, 0x1, 0x7, 0x301, 0x0, 0x0, {0x1, 0x0, 0x1}, [@NFACCT_FLAGS={0x8, 0x5, 0x1, 0x0, 0x3}, @NFACCT_PKTS={0xc, 0x2, 0x1, 0x0, 0x80}, @NFACCT_BYTES={0xc, 0x3, 0x1, 0x0, 0x2}]}, 0x34}}, 0x1)

program did not crash
testing program (duration=15s, {Threaded:true Collide:true Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open-perf_event_open-semget$private-semctl$SETVAL-syz_open_procfs-syz_open_dev$vcsa-ioctl$TIOCGPTPEER-setsockopt$inet6_tcp_TCP_REPAIR-socket$nl_route-fsetxattr$trusted_overlay_redirect-syz_open_dev$vcsa-setsockopt$inet_IP_IPSEC_POLICY
detailed listing:
executing program 0:
perf_event_open(&(0x7f0000000000)={0x0, 0x70, 0x0, 0x0, 0x0, 0x0, 0x0, 0xd7d, 0xa0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_config_ext, 0x0, 0x0, 0x0, 0x0, 0x8000000}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
perf_event_open(&(0x7f00000000c0)={0x7, 0x70, 0x80, 0xfb, 0x74, 0x3a, 0x0, 0x8001, 0x10, 0x6, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x1, 0x2, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1c9, 0x0, @perf_bp={&(0x7f0000000080), 0x5}, 0x0, 0xffffffffffff8001, 0x9, 0x5, 0x400, 0x2, 0xab18}, 0xffffffffffffffff, 0xa, 0xffffffffffffffff, 0x3)
r0 = semget$private(0x0, 0x1, 0x12)
semctl$SETVAL(r0, 0x0, 0x10, &(0x7f0000000240)=0x80000000)
r1 = syz_open_procfs(0xffffffffffffffff, &(0x7f0000000000)='net/route\x00')
r2 = syz_open_dev$vcsa(&(0x7f0000000140)='/dev/vcsa#\x00', 0x2, 0x2040)
ioctl$TIOCGPTPEER(r1, 0x5441, 0xffffffff00000001)
setsockopt$inet6_tcp_TCP_REPAIR(r2, 0x6, 0x13, &(0x7f0000000180), 0x4)
r3 = socket$nl_route(0x10, 0x3, 0x0)
fsetxattr$trusted_overlay_redirect(r3, &(0x7f00000001c0)='trusted.overlay.redirect\x00', &(0x7f0000000200)='./file0\x00', 0x8, 0x3)
r4 = syz_open_dev$vcsa(&(0x7f0000000280)='/dev/vcsa#\x00', 0x0, 0x24100)
setsockopt$inet_IP_IPSEC_POLICY(r4, 0x0, 0x10, &(0x7f00000002c0)={{{@in6=@ipv4={[], [], @remote}, @in6=@mcast1, 0x4e24, 0x9, 0x4e20, 0x1, 0xa, 0x0, 0x20, 0x1d, 0x0, 0xffffffffffffffff}, {0xfffffffffffff73f, 0x2, 0x6, 0xfffffffffffffff8, 0xc270, 0x3, 0x6f1, 0xd25b79f}, {0x5f0, 0x80, 0x9a, 0x5}, 0x10000, 0x6e6bb0, 0x2, 0x1, 0x2, 0x3}, {{@in=@broadcast, 0x4d4, 0x6c}, 0x2, @in6=@remote, 0x3504, 0x3, 0x0, 0xdb, 0x5, 0x100, 0x259b}}, 0xe8)

program crashed: WARNING: stack recursion on stack type 4
single: successfully extracted reproducer
found reproducer with 12 syscalls
minimizing guilty program
testing program (duration=22.5s, {Threaded:true Collide:true Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open-perf_event_open-semget$private-semctl$SETVAL-syz_open_procfs-syz_open_dev$vcsa-ioctl$TIOCGPTPEER-setsockopt$inet6_tcp_TCP_REPAIR-socket$nl_route-fsetxattr$trusted_overlay_redirect-syz_open_dev$vcsa
detailed listing:
executing program 0:
perf_event_open(&(0x7f0000000000)={0x0, 0x70, 0x0, 0x0, 0x0, 0x0, 0x0, 0xd7d, 0xa0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_config_ext, 0x0, 0x0, 0x0, 0x0, 0x8000000}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
perf_event_open(&(0x7f00000000c0)={0x7, 0x70, 0x80, 0xfb, 0x74, 0x3a, 0x0, 0x8001, 0x10, 0x6, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x1, 0x2, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1c9, 0x0, @perf_bp={&(0x7f0000000080), 0x5}, 0x0, 0xffffffffffff8001, 0x9, 0x5, 0x400, 0x2, 0xab18}, 0xffffffffffffffff, 0xa, 0xffffffffffffffff, 0x3)
r0 = semget$private(0x0, 0x1, 0x12)
semctl$SETVAL(r0, 0x0, 0x10, &(0x7f0000000240)=0x80000000)
r1 = syz_open_procfs(0xffffffffffffffff, &(0x7f0000000000)='net/route\x00')
r2 = syz_open_dev$vcsa(&(0x7f0000000140)='/dev/vcsa#\x00', 0x2, 0x2040)
ioctl$TIOCGPTPEER(r1, 0x5441, 0xffffffff00000001)
setsockopt$inet6_tcp_TCP_REPAIR(r2, 0x6, 0x13, &(0x7f0000000180), 0x4)
r3 = socket$nl_route(0x10, 0x3, 0x0)
fsetxattr$trusted_overlay_redirect(r3, &(0x7f00000001c0)='trusted.overlay.redirect\x00', &(0x7f0000000200)='./file0\x00', 0x8, 0x3)
syz_open_dev$vcsa(&(0x7f0000000280)='/dev/vcsa#\x00', 0x0, 0x24100)

program crashed: WARNING: stack recursion on stack type 4
testing program (duration=22.5s, {Threaded:true Collide:true Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open-perf_event_open-semget$private-semctl$SETVAL-syz_open_procfs-syz_open_dev$vcsa-ioctl$TIOCGPTPEER-setsockopt$inet6_tcp_TCP_REPAIR-socket$nl_route-fsetxattr$trusted_overlay_redirect
detailed listing:
executing program 0:
perf_event_open(&(0x7f0000000000)={0x0, 0x70, 0x0, 0x0, 0x0, 0x0, 0x0, 0xd7d, 0xa0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_config_ext, 0x0, 0x0, 0x0, 0x0, 0x8000000}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
perf_event_open(&(0x7f00000000c0)={0x7, 0x70, 0x80, 0xfb, 0x74, 0x3a, 0x0, 0x8001, 0x10, 0x6, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x1, 0x2, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1c9, 0x0, @perf_bp={&(0x7f0000000080), 0x5}, 0x0, 0xffffffffffff8001, 0x9, 0x5, 0x400, 0x2, 0xab18}, 0xffffffffffffffff, 0xa, 0xffffffffffffffff, 0x3)
r0 = semget$private(0x0, 0x1, 0x12)
semctl$SETVAL(r0, 0x0, 0x10, &(0x7f0000000240)=0x80000000)
r1 = syz_open_procfs(0xffffffffffffffff, &(0x7f0000000000)='net/route\x00')
r2 = syz_open_dev$vcsa(&(0x7f0000000140)='/dev/vcsa#\x00', 0x2, 0x2040)
ioctl$TIOCGPTPEER(r1, 0x5441, 0xffffffff00000001)
setsockopt$inet6_tcp_TCP_REPAIR(r2, 0x6, 0x13, &(0x7f0000000180), 0x4)
r3 = socket$nl_route(0x10, 0x3, 0x0)
fsetxattr$trusted_overlay_redirect(r3, &(0x7f00000001c0)='trusted.overlay.redirect\x00', &(0x7f0000000200)='./file0\x00', 0x8, 0x3)

program crashed: WARNING: stack recursion on stack type 4
testing program (duration=22.5s, {Threaded:true Collide:true Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open-perf_event_open-semget$private-semctl$SETVAL-syz_open_procfs-syz_open_dev$vcsa-ioctl$TIOCGPTPEER-setsockopt$inet6_tcp_TCP_REPAIR-socket$nl_route
detailed listing:
executing program 0:
perf_event_open(&(0x7f0000000000)={0x0, 0x70, 0x0, 0x0, 0x0, 0x0, 0x0, 0xd7d, 0xa0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_config_ext, 0x0, 0x0, 0x0, 0x0, 0x8000000}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
perf_event_open(&(0x7f00000000c0)={0x7, 0x70, 0x80, 0xfb, 0x74, 0x3a, 0x0, 0x8001, 0x10, 0x6, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x1, 0x2, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1c9, 0x0, @perf_bp={&(0x7f0000000080), 0x5}, 0x0, 0xffffffffffff8001, 0x9, 0x5, 0x400, 0x2, 0xab18}, 0xffffffffffffffff, 0xa, 0xffffffffffffffff, 0x3)
r0 = semget$private(0x0, 0x1, 0x12)
semctl$SETVAL(r0, 0x0, 0x10, &(0x7f0000000240)=0x80000000)
r1 = syz_open_procfs(0xffffffffffffffff, &(0x7f0000000000)='net/route\x00')
r2 = syz_open_dev$vcsa(&(0x7f0000000140)='/dev/vcsa#\x00', 0x2, 0x2040)
ioctl$TIOCGPTPEER(r1, 0x5441, 0xffffffff00000001)
setsockopt$inet6_tcp_TCP_REPAIR(r2, 0x6, 0x13, &(0x7f0000000180), 0x4)
socket$nl_route(0x10, 0x3, 0x0)

program crashed: WARNING: stack recursion on stack type 4
testing program (duration=22.5s, {Threaded:true Collide:true Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open-perf_event_open-semget$private-semctl$SETVAL-syz_open_procfs-syz_open_dev$vcsa-ioctl$TIOCGPTPEER-setsockopt$inet6_tcp_TCP_REPAIR
detailed listing:
executing program 0:
perf_event_open(&(0x7f0000000000)={0x0, 0x70, 0x0, 0x0, 0x0, 0x0, 0x0, 0xd7d, 0xa0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_config_ext, 0x0, 0x0, 0x0, 0x0, 0x8000000}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
perf_event_open(&(0x7f00000000c0)={0x7, 0x70, 0x80, 0xfb, 0x74, 0x3a, 0x0, 0x8001, 0x10, 0x6, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x1, 0x2, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1c9, 0x0, @perf_bp={&(0x7f0000000080), 0x5}, 0x0, 0xffffffffffff8001, 0x9, 0x5, 0x400, 0x2, 0xab18}, 0xffffffffffffffff, 0xa, 0xffffffffffffffff, 0x3)
r0 = semget$private(0x0, 0x1, 0x12)
semctl$SETVAL(r0, 0x0, 0x10, &(0x7f0000000240)=0x80000000)
r1 = syz_open_procfs(0xffffffffffffffff, &(0x7f0000000000)='net/route\x00')
r2 = syz_open_dev$vcsa(&(0x7f0000000140)='/dev/vcsa#\x00', 0x2, 0x2040)
ioctl$TIOCGPTPEER(r1, 0x5441, 0xffffffff00000001)
setsockopt$inet6_tcp_TCP_REPAIR(r2, 0x6, 0x13, &(0x7f0000000180), 0x4)

program crashed: WARNING: stack recursion on stack type 4
testing program (duration=22.5s, {Threaded:true Collide:true Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open-perf_event_open-semget$private-semctl$SETVAL-syz_open_procfs-syz_open_dev$vcsa-ioctl$TIOCGPTPEER
detailed listing:
executing program 0:
perf_event_open(&(0x7f0000000000)={0x0, 0x70, 0x0, 0x0, 0x0, 0x0, 0x0, 0xd7d, 0xa0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_config_ext, 0x0, 0x0, 0x0, 0x0, 0x8000000}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
perf_event_open(&(0x7f00000000c0)={0x7, 0x70, 0x80, 0xfb, 0x74, 0x3a, 0x0, 0x8001, 0x10, 0x6, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x1, 0x2, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1c9, 0x0, @perf_bp={&(0x7f0000000080), 0x5}, 0x0, 0xffffffffffff8001, 0x9, 0x5, 0x400, 0x2, 0xab18}, 0xffffffffffffffff, 0xa, 0xffffffffffffffff, 0x3)
r0 = semget$private(0x0, 0x1, 0x12)
semctl$SETVAL(r0, 0x0, 0x10, &(0x7f0000000240)=0x80000000)
r1 = syz_open_procfs(0xffffffffffffffff, &(0x7f0000000000)='net/route\x00')
syz_open_dev$vcsa(&(0x7f0000000140)='/dev/vcsa#\x00', 0x2, 0x2040)
ioctl$TIOCGPTPEER(r1, 0x5441, 0xffffffff00000001)

program crashed: WARNING: stack recursion on stack type 4
testing program (duration=22.5s, {Threaded:true Collide:true Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open-perf_event_open-semget$private-semctl$SETVAL-syz_open_procfs-syz_open_dev$vcsa
detailed listing:
executing program 0:
perf_event_open(&(0x7f0000000000)={0x0, 0x70, 0x0, 0x0, 0x0, 0x0, 0x0, 0xd7d, 0xa0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_config_ext, 0x0, 0x0, 0x0, 0x0, 0x8000000}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
perf_event_open(&(0x7f00000000c0)={0x7, 0x70, 0x80, 0xfb, 0x74, 0x3a, 0x0, 0x8001, 0x10, 0x6, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x1, 0x2, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1c9, 0x0, @perf_bp={&(0x7f0000000080), 0x5}, 0x0, 0xffffffffffff8001, 0x9, 0x5, 0x400, 0x2, 0xab18}, 0xffffffffffffffff, 0xa, 0xffffffffffffffff, 0x3)
r0 = semget$private(0x0, 0x1, 0x12)
semctl$SETVAL(r0, 0x0, 0x10, &(0x7f0000000240)=0x80000000)
syz_open_procfs(0xffffffffffffffff, &(0x7f0000000000)='net/route\x00')
syz_open_dev$vcsa(&(0x7f0000000140)='/dev/vcsa#\x00', 0x2, 0x2040)

program crashed: WARNING: stack recursion on stack type 4
testing program (duration=22.5s, {Threaded:true Collide:true Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open-perf_event_open-semget$private-semctl$SETVAL-syz_open_procfs
detailed listing:
executing program 0:
perf_event_open(&(0x7f0000000000)={0x0, 0x70, 0x0, 0x0, 0x0, 0x0, 0x0, 0xd7d, 0xa0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_config_ext, 0x0, 0x0, 0x0, 0x0, 0x8000000}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
perf_event_open(&(0x7f00000000c0)={0x7, 0x70, 0x80, 0xfb, 0x74, 0x3a, 0x0, 0x8001, 0x10, 0x6, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x1, 0x2, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1c9, 0x0, @perf_bp={&(0x7f0000000080), 0x5}, 0x0, 0xffffffffffff8001, 0x9, 0x5, 0x400, 0x2, 0xab18}, 0xffffffffffffffff, 0xa, 0xffffffffffffffff, 0x3)
r0 = semget$private(0x0, 0x1, 0x12)
semctl$SETVAL(r0, 0x0, 0x10, &(0x7f0000000240)=0x80000000)
syz_open_procfs(0xffffffffffffffff, &(0x7f0000000000)='net/route\x00')

program crashed: WARNING: stack recursion on stack type 4
testing program (duration=22.5s, {Threaded:true Collide:true Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open-perf_event_open-semget$private-semctl$SETVAL
detailed listing:
executing program 0:
perf_event_open(&(0x7f0000000000)={0x0, 0x70, 0x0, 0x0, 0x0, 0x0, 0x0, 0xd7d, 0xa0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_config_ext, 0x0, 0x0, 0x0, 0x0, 0x8000000}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
perf_event_open(&(0x7f00000000c0)={0x7, 0x70, 0x80, 0xfb, 0x74, 0x3a, 0x0, 0x8001, 0x10, 0x6, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x1, 0x2, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1c9, 0x0, @perf_bp={&(0x7f0000000080), 0x5}, 0x0, 0xffffffffffff8001, 0x9, 0x5, 0x400, 0x2, 0xab18}, 0xffffffffffffffff, 0xa, 0xffffffffffffffff, 0x3)
r0 = semget$private(0x0, 0x1, 0x12)
semctl$SETVAL(r0, 0x0, 0x10, &(0x7f0000000240)=0x80000000)

program crashed: WARNING: stack recursion on stack type 4
testing program (duration=22.5s, {Threaded:true Collide:true Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open-perf_event_open-semget$private
detailed listing:
executing program 0:
perf_event_open(&(0x7f0000000000)={0x0, 0x70, 0x0, 0x0, 0x0, 0x0, 0x0, 0xd7d, 0xa0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_config_ext, 0x0, 0x0, 0x0, 0x0, 0x8000000}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
perf_event_open(&(0x7f00000000c0)={0x7, 0x70, 0x80, 0xfb, 0x74, 0x3a, 0x0, 0x8001, 0x10, 0x6, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x1, 0x2, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1c9, 0x0, @perf_bp={&(0x7f0000000080), 0x5}, 0x0, 0xffffffffffff8001, 0x9, 0x5, 0x400, 0x2, 0xab18}, 0xffffffffffffffff, 0xa, 0xffffffffffffffff, 0x3)
semget$private(0x0, 0x1, 0x12)

program crashed: WARNING: stack recursion on stack type 4
testing program (duration=22.5s, {Threaded:true Collide:true Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open-perf_event_open
detailed listing:
executing program 0:
perf_event_open(&(0x7f0000000000)={0x0, 0x70, 0x0, 0x0, 0x0, 0x0, 0x0, 0xd7d, 0xa0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_config_ext, 0x0, 0x0, 0x0, 0x0, 0x8000000}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
perf_event_open(&(0x7f00000000c0)={0x7, 0x70, 0x80, 0xfb, 0x74, 0x3a, 0x0, 0x8001, 0x10, 0x6, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x1, 0x2, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1c9, 0x0, @perf_bp={&(0x7f0000000080), 0x5}, 0x0, 0xffffffffffff8001, 0x9, 0x5, 0x400, 0x2, 0xab18}, 0xffffffffffffffff, 0xa, 0xffffffffffffffff, 0x3)

program crashed: WARNING: stack recursion on stack type 4
testing program (duration=22.5s, {Threaded:true Collide:true Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open
detailed listing:
executing program 0:
perf_event_open(&(0x7f0000000000)={0x0, 0x70, 0x0, 0x0, 0x0, 0x0, 0x0, 0xd7d, 0xa0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_config_ext, 0x0, 0x0, 0x0, 0x0, 0x8000000}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)

program crashed: WARNING: stack recursion on stack type 4
testing program (duration=22.5s, {Threaded:true Collide:true Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): 
detailed listing:
executing program 0:

program did not crash
testing program (duration=22.5s, {Threaded:true Collide:true Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open
detailed listing:
executing program 0:
perf_event_open(0x0, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)

program did not crash
extracting C reproducer
testing compiled C program (duration=22.5s, {Threaded:true Collide:true Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open
program crashed: WARNING: stack recursion on stack type 4
simplifying C reproducer
testing compiled C program (duration=22.5s, {Threaded:true Collide:false Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open
program crashed: WARNING: stack recursion on stack type 4
testing compiled C program (duration=22.5s, {Threaded:false Collide:false Repeat:true RepeatTimes:0 Procs:4 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open
program crashed: WARNING: stack recursion on stack type 4
testing compiled C program (duration=22.5s, {Threaded:false Collide:false Repeat:false RepeatTimes:0 Procs:1 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:false Cgroups:false BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open
program did not crash
testing compiled C program (duration=22.5s, {Threaded:false Collide:false Repeat:true RepeatTimes:0 Procs:1 Sandbox:none Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open
program crashed: WARNING: stack recursion on stack type 4
testing compiled C program (duration=22.5s, {Threaded:false Collide:false Repeat:true RepeatTimes:0 Procs:1 Sandbox: Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:false NetReset:false Cgroups:false BinfmtMisc:false CloseFDs:false KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:true HandleSegv:true Repro:true Trace:false}): perf_event_open
program crashed: WARNING: stack recursion on stack type 4
testing compiled C program (duration=22.5s, {Threaded:false Collide:false Repeat:true RepeatTimes:0 Procs:1 Sandbox: Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:false NetReset:false Cgroups:false BinfmtMisc:false CloseFDs:false KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:false HandleSegv:true Repro:true Trace:false}): perf_event_open
program crashed: WARNING: stack recursion on stack type 4
testing compiled C program (duration=22.5s, {Threaded:false Collide:false Repeat:true RepeatTimes:0 Procs:1 Sandbox: Fault:false FaultCall:-1 FaultNth:0 Leak:false NetInjection:false NetDevices:false NetReset:false Cgroups:false BinfmtMisc:false CloseFDs:false KCSAN:false DevlinkPCI:false USB:false VhciInjection:false UseTmpDir:false HandleSegv:false Repro:true Trace:false}): perf_event_open
program crashed: WARNING: stack recursion on stack type 4
reproducing took 5m13.895039242s
repro crashed as (corrupted=false):
000: perf: interrupt took too long (10106 > 10037), lowering kernel.perf_event_max_sample_rate to 19000
000: perf: interrupt took too long (12687 > 12632), lowering kernel.perf_event_max_sample_rate to 15000
001: WARNING: stack recursion on stack type 4
001: WARNING: can't dereference registers at 000000006f4c4573 for ip swapgs_restore_regs_and_return_to_usermode+0x25/0x80
001: INFO: NMI handler (perf_event_nmi_handler) took too long to run: 2.819 msecs
001: perf: interrupt took too long (34012 > 15858), lowering kernel.perf_event_max_sample_rate to 5000

final repro crashed as (corrupted=false):
000: perf: interrupt took too long (10106 > 10037), lowering kernel.perf_event_max_sample_rate to 19000
000: perf: interrupt took too long (12687 > 12632), lowering kernel.perf_event_max_sample_rate to 15000
001: WARNING: stack recursion on stack type 4
001: WARNING: can't dereference registers at 000000006f4c4573 for ip swapgs_restore_regs_and_return_to_usermode+0x25/0x80
001: INFO: NMI handler (perf_event_nmi_handler) took too long to run: 2.819 msecs
001: perf: interrupt took too long (34012 > 15858), lowering kernel.perf_event_max_sample_rate to 5000

